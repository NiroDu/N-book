(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{324:function(s,t,n){"use strict";n.r(t);var e=n(0),a=Object(e.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"content"},[s._m(0),s._v(" "),s._m(1),s._v(" "),s._m(2),s._v(" "),n("p",[s._v("由于我们会把包发布到公共的 npm 源，如果你还没有 "),n("code",[s._v("npm")]),s._v(" 账号，那么需要先去"),n("a",{attrs:{href:"https://www.npmjs.com/signup",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网注册"),n("OutboundLink")],1),s._v("。注册完成后，可以去终端执行 "),n("code",[s._v("npm login")]),s._v(" 登录。这个步骤非常重要，决定你最终能否发布成功。")]),s._v(" "),s._m(3),s._v(" "),n("p",[s._v("我们会利用 "),n("a",{attrs:{href:"https://github.com/rollup/rollup",target:"_blank",rel:"noopener noreferrer"}},[s._v("rollup"),n("OutboundLink")],1),s._v(" 来打包我们的 "),n("code",[s._v("ts-axios")]),s._v(" 库，它是一个非常著名的编译打包工具，Vue.js 也是利用 rollup 编译打包的。相比 webpack，它非常适合去编译和打包一些 JS 库。")]),s._v(" "),s._m(4),s._v(" "),s._m(5),s._v(" "),s._m(6),s._m(7),s._v(" "),s._m(8),s._v(" "),s._m(9),s._v(" "),n("p",[s._v("表示打包入口文件。")]),s._v(" "),s._m(10),s._v(" "),s._m(11),s._v(" "),s._m(12),s._v(" "),n("p",[s._v("声明它的外部依赖，可以不被打包进去。")]),s._v(" "),s._m(13),s._v(" "),s._m(14),s._v(" "),s._m(15),s._v(" "),s._m(16),s._v(" "),s._m(17),s._v(" "),s._m(18),s._v(" "),s._m(19),s._m(20),s._v(" "),s._m(21),s._v(" "),s._m(22),s._v(" "),s._m(23),s._v(" "),s._m(24),s._v(" "),s._m(25),s._v(" "),n("p",[s._v("另外我们增加 2 个 npm scripts：")]),s._v(" "),s._m(26),s._m(27),s._v(" "),s._m(28),s._v(" "),s._m(29),s._v(" "),s._m(30),s._v(" "),s._m(31),s._v(" "),s._m(32),s._v(" "),s._m(33),n("p",[s._v("部署脚本是 shell 脚本，shell 脚本就是封装了多行控制台命令，来逐行解释他们的含义。")]),s._v(" "),s._m(34),s._v(" "),s._m(35),s._v(" "),s._m(36),s._v(" "),s._m(37),s._v(" "),s._m(38),s._v(" "),s._m(39),s._v(" "),s._m(40),s._v(" "),s._m(41),s._v(" "),s._m(42),s._v(" "),s._m(43),s._v(" "),s._m(44),s._v(" "),s._m(45),s._v(" "),s._m(46),s._v(" "),s._m(47),s._v(" "),s._m(48),s._v(" "),s._m(49),s._m(50),s._v(" "),s._m(51),s._v(" "),n("p",[s._v("通过编写部署脚本的一行命令发布的方式，不仅可以用在这种 JS 库，也可以用于我们平时项目开发中，可以大大帮助我们提高生产率，也是前端工程化中必不可少的一个环节，希望同学们都能学会并掌握它。")]),s._v(" "),s._m(52)])}),[function(){var s=this.$createElement,t=this._self._c||s;return t("h1",{attrs:{id:"ts-axios-编译与发布"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ts-axios-编译与发布"}},[this._v("#")]),this._v(" ts-axios 编译与发布")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"需求分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#需求分析"}},[this._v("#")]),this._v(" 需求分析")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("前面的章节我们完成 "),t("code",[this._v("ts-axios")]),this._v(" 库的代码编写和单元测试。这一章我们希望把代码部署发布到公共 "),t("code",[this._v("npm")]),this._v(" 上，供别人下载使用。但是并不是所有人都会使用 TypeScript 开发，仍然有大量的 JavaScript 用户，它们是不能直接引用 TypeScript 代码的，因此我们需要先对源码做编译和打包，然后再发布。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"编译和打包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编译和打包"}},[this._v("#")]),this._v(" 编译和打包")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("由于使用 "),t("code",[this._v("typescript-library-starter")]),this._v(" 初始化我们的项目，我们已经拥有了 rollup 打包的相关配置和相关插件的安装，接下来我们就来对生成的 "),t("code",[this._v("rollup.config.ts")]),this._v(" 做小小的修改。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"修改-rollup-config-ts"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改-rollup-config-ts"}},[this._v("#")]),this._v(" 修改 rollup.config.ts")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-typescript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-typescript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" resolve "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rollup-plugin-node-resolve'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" commonjs "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rollup-plugin-commonjs'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" sourceMaps "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rollup-plugin-sourcemaps'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" camelCase "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lodash.camelcase'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" typescript "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rollup-plugin-typescript2'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" json "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rollup-plugin-json'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" pkg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./package.json'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" libraryName "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'axios'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  input"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("src/index.ts")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  output"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pkg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("main"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("camelCase")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("libraryName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" format"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'umd'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sourcemap"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pkg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("module")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" format"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'es'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sourcemap"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Indicate here external modules you don't wanna include in your bundle (i.e.: 'lodash')")]),s._v("\n  external"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  watch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    include"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'src/**'")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  plugins"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Allow json resolution")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" Compile TypeScript files\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("typescript")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" useTsconfigDeclarationDir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" Allow bundling cjs "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("modules")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("unlike webpack"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" rollup doesn't understand cjs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("commonjs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" Allow node_modules resolution"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" so you can use "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'external'")]),s._v(" to control\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" which external modules to include "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the bundle\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" https"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("github"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rollup"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rollup"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("plugin"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("resolve#usage\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" Resolve source maps to the original source\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sourceMaps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[s._v("注意要修改的地方，把 "),n("code",[s._v("libraryName")]),s._v(" 修改为 "),n("code",[s._v("axios")]),s._v("，"),n("code",[s._v("input")]),s._v(" 修改为 "),n("code",[s._v("src/index.ts")]),s._v("。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v("rollup")]),this._v(" 的配置很简单，我们简单地过一下。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("ul",[t("li",[this._v("input")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("ul",[t("li",[this._v("output")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("表示输出的目标文件，它是一个对象数组，我们可以指定输出的格式，比如 "),t("code",[this._v("umd")]),this._v(" 格式、"),t("code",[this._v("es")]),this._v(" 模式等。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("ul",[t("li",[this._v("external")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("ul",[t("li",[this._v("watch")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("监听文件的变化，重新编译，只有在编译的时候开启 "),t("code",[this._v("--watch")]),this._v(" 才生效。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("ul",[t("li",[this._v("plugins")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[s._v("编译过程中使用的插件，其中 "),n("code",[s._v("rollup-plugin-typescript2")]),s._v(" 就是用来编译 TypeScript 文件，"),n("code",[s._v("useTsconfigDeclarationDir")]),s._v(" 表示使用 "),n("code",[s._v("tsconfig.json")]),s._v(" 文件中定义的 "),n("code",[s._v("declarationDir")]),s._v("。其它插件感兴趣的同学可以自己去查阅文档。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"修改-package-json"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改-package-json"}},[this._v("#")]),this._v(" 修改 package.json")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[s._v("由于我们已经在 "),n("code",[s._v("rollup.config.ts")]),s._v(" 中修改了 "),n("code",[s._v("libraryName")]),s._v(" 为 "),n("code",[s._v("axios")]),s._v("， 那么在 "),n("code",[s._v("package.json")]),s._v(" 文件中你需要做相关的修改：")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-typescript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-typescript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dist/axios.umd.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dist/axios.es5.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"typings"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dist/types/index.d.ts"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[s._v("然后我们在控制台执行 "),n("code",[s._v("npm run build")]),s._v("，会编译输出 "),n("code",[s._v("dist")]),s._v(" 目录，其中 "),n("code",[s._v("lib")]),s._v(" 目录是单个 "),n("code",[s._v(".ts")]),s._v(" 文件编译后的 "),n("code",[s._v(".js")]),s._v(" 文件。"),n("code",[s._v("types")]),s._v(" 目录是所有 "),n("code",[s._v(".ts")]),s._v(" 文件编译后生产的 "),n("code",[s._v(".d.ts")]),s._v(" 声明文件。"),n("code",[s._v("axios.es5.js")]),s._v(" 是编译后生成的 es 模式的入口文件，用在 "),n("code",[s._v("package.json")]),s._v(" 的 "),n("code",[s._v("module")]),s._v(" 字段，"),n("code",[s._v("axios.umd.js")]),s._v(" 文件是编译后生成的 "),n("code",[s._v("umd")]),s._v(" 模式的入口文件，用在 "),n("code",[s._v("package.json")]),s._v(" 的 "),n("code",[s._v("main")]),s._v(" 字段。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"自动化部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自动化部署"}},[this._v("#")]),this._v(" 自动化部署")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("由于 "),t("code",[this._v("semantic-release")]),this._v(" 插件过于黑盒也略微重量，我还是决定教同学们自己编写自动化部署脚本，这样更灵活，意义也更大，因为大部分场景是用不到那么多 feature 的。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"修改-package-json-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改-package-json-2"}},[this._v("#")]),this._v(" 修改 package.json")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[s._v("发布到 npm 之前你需要为你的包命名，由于 "),n("code",[s._v("ts-axios")]),s._v(" 这个名字已经被占用了，我使用了 "),n("code",[s._v("ts-axios-new")]),s._v(" 这个名称，当然你学到这里，就需要起一个新名字了。可以使用 "),n("code",[s._v("npm view [<@scope>/]<pkg>[@<version>]")]),s._v(" 的方式去搜索一个包名是否已经存在，比如你搜索 "),n("code",[s._v("npm view ts-axios-new")]),s._v(" 会发现这个包已经存在，返回这个包相关信息。如果你搜索 "),n("code",[s._v("npm view xxxx")]),s._v(" 返回错误 404 的话，那么你就可以使用 "),n("code",[s._v("xxxx")]),s._v(" 这个包名了。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("如果你想让你发布的包关联你的仓库地址，可以配置 "),t("code",[this._v("repository")]),this._v(" 的 "),t("code",[this._v("url")]),this._v(" 字段。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"prepub"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"npm run test:prod && npm run build"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"pub"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sh release.sh"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[s._v("当我们运行 "),n("code",[s._v("npm run pub")]),s._v(" 的时候，会优先执行 "),n("code",[s._v("prepub")]),s._v(" 脚本，在 "),n("code",[s._v("prepub")]),s._v(" 中我们运行了 "),n("code",[s._v("test:prod")]),s._v(" 和 "),n("code",[s._v("build")]),s._v(" 2 个脚本。"),n("code",[s._v("&&")]),s._v(" 符号表示前面一个命令执行成功后才会执行后面的任务。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[n("code",[s._v("npm run test:prod")]),s._v(" 实际上运行了 "),n("code",[s._v("npm run lint && npm run test -- --no-cache")]),s._v("。 先运行 "),n("code",[s._v("lint")]),s._v(" 去校验我们的源码和测试文件是否遵循 "),n("code",[s._v("tslint")]),s._v(" 规范，再运行 "),n("code",[s._v("test")]),s._v(" 去跑测试。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[n("code",[s._v("npm run build")]),s._v(" 实际上运行了 "),n("code",[s._v("tsc --module commonjs")]),s._v("、"),n("code",[s._v("rollup -c rollup.config.ts")]),s._v(" 和 "),n("code",[s._v("typedoc --out docs --target es6 --theme minimal --mode file src")]),s._v("。先运行 "),n("code",[s._v("tsc")]),s._v(" 去编译我们的 "),n("code",[s._v("TypeScript")]),s._v(" 文件，"),n("code",[s._v("dist/lib")]),s._v(" 和 "),n("code",[s._v("dist/types")]),s._v(" 下的文件就是该命令产生的，然后运行 "),n("code",[s._v("rollup")]),s._v(" 去构建 "),n("code",[s._v("axios.umd.js")]),s._v(" 及 "),n("code",[s._v("axios.es.js")]),s._v("，最后运行 "),n("code",[s._v("typedoc")]),s._v(" 去构建项目的文档。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[s._v("运行完 "),n("code",[s._v("prepub")]),s._v(" 后就会再运行 "),n("code",[s._v("pub")]),s._v(" 命令，实际上执行了 "),n("code",[s._v("sh release.sh")]),s._v(" 命令，但是目前我们没有这个脚本，接下来我们就需要来编写部署脚本 "),n("code",[s._v("release.sh")]),s._v("。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h3",{attrs:{id:"编写部署脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编写部署脚本"}},[this._v("#")]),this._v(" 编写部署脚本")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v("release.sh")]),this._v("：")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/usr/bin/env sh")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" -e\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Enter release version: "')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" VERSION\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" -p "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Releasing '),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$VERSION")]),s._v(' - are you sure? (y/n)"')]),s._v(" -n "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -r\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# (optional) move to a new line")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$REPLY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("~ ^"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Yy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Releasing '),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$VERSION")]),s._v(' ..."')]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# commit")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -A\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit -m "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[build] '),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$VERSION")]),s._v('"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" version "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$VERSION")]),s._v(" --message "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[release] '),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$VERSION")]),s._v('"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push origin master\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# publish")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" publish\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v("#!/usr/bin/env sh")]),this._v(" 用来表示它是一个 shell 脚本。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v("set -e")]),this._v(" 告诉脚本如果执行结果不为 true 则退出。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v('echo "Enter release version: "')]),this._v(" 在控制台输出 "),t("code",[this._v("Enter release version:")]),this._v("。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v("read VERSION")]),this._v(" 表示从标准输入读取值，并赋值给 $VERSION 变量。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[n("code",[s._v('read -p "Releasing $VERSION - are you sure? (y/n)" -n 1 -r')]),s._v("，其中 "),n("code",[s._v("read -p")]),s._v(" 表示给出提示符，后面接着 "),n("code",[s._v("Releasing $VERSION - are you sure? (y/n)")]),s._v(" 提示符；"),n("code",[s._v("-n 1")]),s._v(" 表示限定最多可以有 1 个字符可以作为有效读入；"),n("code",[s._v("-r")]),s._v(" 表示禁止反斜线的转义功能。因为我们的 read 并没有指定变量名，那么默认这个输入读取值会赋值给 "),n("code",[s._v("$REPLY")]),s._v(" 变量。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v("echo")]),this._v(" 输出空值表示跳到一个新行，"),t("code",[this._v("#")]),this._v(" 在 shell 脚本中表示注释。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[n("code",[s._v("if [[ $REPLY =~ ^[Yy]$ ]]")]),s._v(" 表示 shell 脚本中的流程控制语句，判断 "),n("code",[s._v("$REPLY")]),s._v(" 是不是大小写的 "),n("code",[s._v("y")]),s._v("，如果满足，则走到后面的 "),n("code",[s._v("then")]),s._v(" 逻辑。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v('echo "Releasing $VERSION ..."')]),this._v("  在控制台输出 "),t("code",[this._v("Releasing $VERSION ...")]),this._v("。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v("git add -A")]),this._v(" 表示把代码所有变化提交到暂存区。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v('git commit -m "[build] $VERSION"')]),this._v(" 表示提交代码，提交注释是 "),t("code",[this._v("[build] $VERSION")]),this._v("。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[n("code",[s._v('npm version $VERSION --message "[release] $VERSION"')]),s._v(" 是修改 "),n("code",[s._v("package.json")]),s._v(" 中的 "),n("code",[s._v("version")]),s._v(" 字段到 "),n("code",[s._v("$VERSION")]),s._v("，并且提交一条修改记录，提交注释是 "),n("code",[s._v("[release] $VERSION")]),s._v("。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v("git push origin master")]),this._v(" 是把代码发布到主干分支。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[n("code",[s._v("npm publish")]),s._v(" 是把仓库发布到 "),n("code",[s._v("npm")]),s._v(" 上，我们会把 "),n("code",[s._v("dist")]),s._v(" 目录下的代码都发布到 "),n("code",[s._v("npm")]),s._v(" 上，因为我们在 "),n("code",[s._v("package.json")]),s._v(" 中配置的是 "),n("code",[s._v("files")]),s._v(" 是 "),n("code",[s._v('["dist"]')]),s._v("。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("h2",{attrs:{id:"运行部署脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行部署脚本"}},[this._v("#")]),this._v(" 运行部署脚本")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[s._v("接下来我们就运行 "),n("code",[s._v("npm run pub")]),s._v(" 脚本部署，我们会发现在 "),n("code",[s._v("npm run prepub")]),s._v(" 阶段，在执行 "),n("code",[s._v("tslint --project tsconfig.json -t codeFrame 'src/**/*.ts' 'test/**/*.ts'")]),s._v(" 的时候失败了，原因是我们有代码不符合 lint 规范。原来是 "),n("code",[s._v("core/xhr.ts")]),s._v(" 文件中 "),n("code",[s._v("processCancel")]),s._v(" 函数中对 "),n("code",[s._v("promise")]),s._v(" 的处理，我们没有对异常情况处理，所以我们要给它加上 "),n("code",[s._v("catch")]),s._v(" 的逻辑：")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-typescript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-typescript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("processCancel")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cancelToken"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    cancelToken"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("promise\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("reason")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        request"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("abort")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("reject")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reason"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* istanbul ignore next */")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// do nothing")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("由于我们不会走到 "),t("code",[this._v("catch")]),this._v(" 逻辑，所以我们给它添加一个注释 "),t("code",[this._v("/* istanbul ignore next */")]),this._v(" 忽略该代码分支的测试。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("p",[s._v("然后我们再重新运行 "),n("code",[s._v("npm run pub")]),s._v(" 逻辑，它会先执行 "),n("code",[s._v("test")]),s._v("，然后运行 "),n("code",[s._v("build")]),s._v(" 编译代码，再执行 "),n("code",[s._v("release.sh")]),s._v(" 脚本。我们输入了要发布的版本，它就可以完成了整个代码的发布流程。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("至此我们完成了项目的部署和发布，我们也可以在 "),t("code",[this._v("npm")]),this._v(" 官网上看到我们发布的包，下一节课我们来创建一个实际项目，来引用我们开发的 "),t("code",[this._v("ts-axios")]),this._v(" 库。")])}],!1,null,null,null);t.default=a.exports}}]);